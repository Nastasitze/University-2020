**Министерство науки и высшего образования Российской Федерации**

**Федеральное государственное бюджетное образовательное учреждение высшего образования**

**«Костромской государственный университет» (КГУ)**

**Институт автоматизированных систем и технологий**

**Направление подготовки: 09.03.02 Информационные системы и технологии**

**Профиль: Информационнные системы и технологии в медиаиндустрии**

**Выполнил студент: Дударева А.Д.**

**Номер группы: 20-ИМбо-3**

**Номер студента: 05**

**Лабораторная работа № 9** 

**Тема: "Работа с инструментами для резервного копирования (бэкапов) Rsync"**

-----
#### Раздел 1. Перечень команд
> **sudo su** - получили права суперпользователя;

> **/home/dudsmir/scr3.sh** - создали пустой файл *scr2.sh* для скрипта в каталоге */home/dudsmir*;
> 
> **chmod +x ./scr3.sh** - сделали файл со скриптом *scr2.sh* исполняемым;

> **mc** - запуск Midnight Commander;

 ```javascript
 #!/bin/bash    /*указываем оболочку первой строкой внутри файла скрипта, которую мы собираемся использовать*/
 if [-n "$1"]   /*проверяем условие наличия вводимого параметра*/
 then           /*далее мы проверяем, какой параметр был введен:*/
 
	 case "$1" in          /* если был введен параметр '-b', то выполняем резервное копирование каталога '/var/tmp': */
		 -b) echo "-b param"  
                        /* (1) с помощью md5sum /var/tmp/*.* - подсчитали контрольную сумму для файлов, хранящихся в каталоге '/var/tmp' */
                        /* Причем, мы считаем контрольные суммы только для файлов вида '*.*', таким образом, исключая подкатологи */
		     md5sum /var/tmp/*.* | awk {'print $1'} > /home/dudsmir/csum.txt 
       /*(2) и сохраняем результаты вычисления в файл 'csum.txt', который находится в катологе '/home/dudsmir',*/ 
       /*причем, записываем в файл 'csum.txt' (который находится в каталоге '/home/dudsmir') только первое слово - ' awk {'print $1'}' (первый столбик)*/
       
		     rsync -avzhe ssh --exclude 'systemd*' /var/tmp dudsmir@192.168.111.111:/home/dudsmir;; 
       /* (3) Далее синхронизируем файлы по ssh: */
       /* rsync [опции] источник приемник | rsync - команда для синхронизации файлов, катологов с локального ПК на удаленный и наоборот */
       /* ssh - используем ssh* для транспортировки файлов */
       /* -avzhe <=> -a - режим архивирования, когда сохраняются все атрибуты оригинальных файлов; */
                     /*-v - выводить подробную информацию о процессе копирования; */
                     /*-z - сжимать файлы перед передачей;                */
                     /*-h - копировать жесткие ссылки;                    */
                     /*-e - использовать другой транспорт, например, ssh; */
       /* --exclude - исключить файлы по шаблону. В нашем случае, исключить все файлы, которые начинаются с 'systemd*' */
       /* /var/tmp - (источник) указали файл, для которого хотим сделать резервную копию на удаленной машине; */
       /* dudsmir@192.168.111.111:/home/dudsmir - (приемник) указали адрес удаленной машины, */
       /* на которую делаю резервное копирование, а также написали, в какое место поместим резервную копию каталога '/var/tmp' */
      
      
		 -v) echo "-v param"  
       /* если был введен параметр '-v', то выполняем проверку правильности скопированных данных: */
 		    rsync -avzhe ssh --exclude 'systemd*' dudsmir@192.168.111.111:/home/dudsmir/tmp/* /home/dudsmir/test09
       /* (1) Выполнили обратное копирование сохраненных файлов из каталога для резервных копий с удаленной машины в промежуточный каталог для проверки: */
       /* dudsmir@192.168.111.111:/home/dudsmir/tmp/* - (источник) указали каталог, для которого хотим сделать резервную копию */
       /* (данный католого находится на удаленной машине). '*' указывает на то, что копируем все файлы из каталога */
       /* /home/dudsmir/test09 - (приемник) указали место на локальной машине, куда хотим поместить резервную копию.*/     
       
       /* (2) с помощью md5sum подсчитали контрольные суммы для всех ('*') файлов, находящиеся в каталоге '/home/dudsmir', */
       /* причем, записываем в файл 'csum2.txt' (который находится в каталоге '/home/dudsmir') */
		     md5sum /home/dudsmir/test09/* | awk {'print $1'} > /home/dudsmir/csum2.txt 
       /* только первое слово - ' awk {'print $1'}' (первый столбик)*/
		     if diff -q csum.txt csum2.txt /* с помощью diff проверили совпадение записей в файлах 'csum.txt' и 'csum2.txt' */
                                     /* -q - выводить только отличия файлов. */
		     then echo "success" /* Если отличий нет, то выводим - "success" */
		     else echo "failed, different!" /* В противном случае выводим - "failed, different!" */
		     fi;;
      
      /* Обработка исключения и вывод сообщения, когда параметр отличен от '-b' и '-v'*/
		  *) echo "$1 no option" 
	 esac
	 shift
  
  /* Обработка исключения и вывод сообщения, когда скрипт был вызван без параметра */
 else echo "input is null" 
 fi
 
  ```

> **./scr2.sh dudsmir** - вызов скрипта с параметром *dudsmir*;

-----
#### Раздел 2. Ответы на вопросы
-----
#### Раздел 3. Выводы
-----

Таким образом, получили опыт в настройке процедур и механизмов обеспечения резервного копирования в
Linux. 