**Министерство науки и высшего образования Российской Федерации**

**Федеральное государственное бюджетное образовательное учреждение высшего образования**

**«Костромской государственный университет» (КГУ)**

**Институт автоматизированных систем и технологий**

**Направление подготовки: 09.03.02 Информационные системы и технологии**

**Профиль: Информационнные системы и технологии в медиаиндустрии**

**Выполнил студент: Дударева А.Д.**

**Номер группы: 20-ИМбо-3**

**Номер студента: 05**

**Лабораторная работа № 6** 

**Тема: "Firewall в Linux"**

---

#### Раздел 1. Перечень команд

---
> **Создали клон основной виртуальной машины.**

> **sudo su** - получили права суперпользователя у VM1;

> **ip a** - посмотрели, какие устройства есть в системе VM1. Получили, что у адаптера enp0s8 нет IP-адреса.  
> *-a, -all* - применить команду ко всем объектам;

> **vi /etc/netplan/02-networkd.yaml** - редактируем содержимое файла с расширением yaml (данный файл находится по пути /etc/netplan/1-network-manager-all.yaml).  
> *vi [filename]* - активизирует экранно-ориентированный редактор для файла;

>  **Дополним содержалие файла:**  
```
network:  
  version: 2  /*версия YAML*/
  renderer: NetworkManager /*программа для обработки конфигурации*/
  ethernets:  /*настройка сетевых адаптеров ethernet*/
    enp0s8:  /* настройки для соответствующих сетевых адаптеров. В данном примере мы настраиваем 1-н адаптер - enp0s8*/
      dhcp4: no  /*получение IPv4 адреса по DHCP*/
      addresses: [ 192.168.111.0/24 ]  /*сетевой адрес с маской /24, который присваивается нашей сетевой карте*/
      gateway4: 192.168.111.10  /*задает адрес роутера, через который компьютер сможет получить доступ в интернет*/
      nameservers:  /*указывает DNS-серверы*/
        addresses: [ 8.8.8.8, 8.8.4.4 ]  /*публичные серверы DNS от Google*/
```

> **netplan --debug generate** - проверим конфигурационный файл на ошибки и создать файлы конфигурации программы-обработчика.  
> *--debug* -  получаем более подробную информацию о результатах проверки нашего конфигурационного файла.  
> *generate* - проверка нашего конфигурационного файла;

> **netplan --debug apply** -  применяем конфигурацию.  
> *--debug* -  получаем более подробную информацию о применении конфигурации.  
> *apply* - применить конфигурацию;

> **apt install isc-dhcp-server** - установили пакет isc-dhcp-server;

> **nano /etc/default/isc-dhcp-server** - отредактировали файл в файловом редакторе *nano*, вписав в INTERFACESv4 наш адаптер enp0s8:
```
INTERFACESv4="enp0s8"
INTERFACESv6=""
```

> **cp /etc/dhcp/dhcpd.conf{,.backup}** - *cp ... {,.backup}* - создаем для файла *dhcpd.conf*, находящегося в */etc/dhcp/dhcpd.conf*, резервную копию. 
>    
> **cat /dev/null > /etc/dhcp/dhcpd.conf** -  *cat file* - прочитали данные из файла *file* и выводим их на экран.  
> *cat /dev/null > /etc/dhcp/dhcpd.conf* - записали результат чтения и вывода команды *cat* в файл *dhcpd.conf*, находящийся в */etc/dhcp/dhcpd.conf*.  
>   
> Другими словами, сделали резервную копию конфигурационного файла;

> **mc** - используем midnight commander для редактирования файл /etc/dhcp/dhcpd.conf;
```
subnet 192.168.111.0 netmask 255.255.255.0 { /* subnet - объявляет подсеть 192.168.111.0 с маской (netmask) 255.255.255.0 */
 range 192.168.111.11 192.168.111.254; /* Диапазон выдаваемых адресов: от 192.168.111.11 до 192.168.111.254 */
 option subnet-mask 255.255.255.0; /* Маска сети - 255.255.255.0 */
 option broadcast-address 192.168.111.255; /* Широковещательный адрес - 192.168.111.255 */
 option domain-name-servers 8.8.8.8, 8.8.4.4; /* Адреса серверов DNS - 8.8.8.8, 8.8.4.4 */
 option domain-name "workgroup"; /* Доменное имя - workgroup */
 option routers 192.168.111.10; /* Определяет IP-адрес вашего шлюза или точки выхода в сеть - 192.168.111.10 */
 default-lease-time 7200; /* Срок действия арендованного IP-адреса */
 max-lease-time 480000; /* Максимальное время истечения срока действия для IP-адреса, арендуемого DHCP-сервером */
 }
```

> **systemctl restart isc-dhcp-server** -  перезапустили сервер *dhcp*, чтобы применить новую конфигурацию.  
> *restart* - перезапустить службу *isc-dhcp-server*;

> **systemctl status isc-dhcp-server** - проверили статус службы *isc-dhcp-server*.  
> *status* - посмотреть состояние и вывод службы;

> **mc** - используем midnight commander для редактирования файл /etc/dhcp/dhcpd.conf;
 ```
subnet 192.168.111.0 netmask 255.255.255.0 {
 range 192.168.111.11 192.168.111.254;
 option subnet-mask 255.255.255.0;
 option broadcast-address 192.168.111.255;
 option domain-name-servers 8.8.8.8, 8.8.4.4;
 option domain-name "workgroup";
 option routers 192.168.111.10;
 default-lease-time 7200;
 max-lease-time 480000;
 
 /*Дописали данный фрагмент:*/
 host ds {
  hardware ethernet 08:60:6e:d6:5e:ff; /* фактический MAC адрес того интерфейса, для которого последует настройка */
  fixed-address 192.168.38.5;} /* IP адрес который будет назначен интерфейсу */
 }
```
> **systemctl restart isc-dhcp-server** -  перезапустили сервер dhcp, чтобы применить новую конфигурацию.  
> *restart* - перезапустить службу *isc-dhcp-server*;

---

#### Раздел 2. Ответы на вопросы

---

#### Раздел 3. Выводы

---

Таким образом, мы получили опыт в клонировании виртуальной машины и осуществления первичной настройки
сети в среде виртуализации Oracle VirtualBox, а также в осуществлении первичной настройки сети с помощью netplan, DHCP-сервера на ОС Linux.